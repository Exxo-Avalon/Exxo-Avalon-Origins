--- src/Terraria/Terraria/GameContent/UI/EmoteBubble.cs
+++ src/Avalon/Terraria/GameContent/UI/EmoteBubble.cs
@@ -9,7 +_,7 @@
 {
 	public class EmoteBubble
 	{
-		private static int[] CountNPCs = new int[665];
+		private static int[] CountNPCs = new int[Main.maxNPCTypes];
 		public static Dictionary<int, EmoteBubble> byID = new Dictionary<int, EmoteBubble>();
 		private static List<int> toClean = new List<int>();
 		public static int NextID;
@@ -337,7 +_,7 @@
 		}
 
 		private void ProbeTownNPCs(List<int> list) {
-			for (int i = 0; i < 665; i++) {
+			for (int i = 0; i < Main.maxNPCTypes; i++) {
 				CountNPCs[i] = 0;
 			}
 
@@ -347,7 +_,7 @@
 			}
 
 			int type = ((NPC)anchor.entity).type;
-			for (int k = 0; k < 665; k++) {
+			for (int k = 0; k < Main.maxNPCTypes; k++) {
 				if (NPCID.Sets.FaceEmote[k] > 0 && CountNPCs[k] > 0 && k != type)
 					list.Add(NPCID.Sets.FaceEmote[k]);
 			}
